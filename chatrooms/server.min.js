function send404(a){a.writeHead(404,{"Content-Type":"text/plain"}),a.write("Error 404: resource not found"),a.end()}function sendFile(a,b,c){a.writeHead(202,{"Content-Type":mime.lookup(path.basename(b))}),a.end(c)}function serveStatic(a,b,c){b[c]?sendFile(a,c,b[c]):fs.exists(c,function(d){d?fs.readFile(c,function(d,e){d?send404(a):(b[c]=e,sendFile(a,c,e))}):send404(a)})}var http=require("http"),fs=require("fs"),path=require("path"),mime=require("mime"),cache={},server=http.createServer(function(a,b){var c=!1;c="/"===a.url?"public/index.html":"public"+a.url;var d="./"+c;serveStatic(b,cache,d)});server.listen(3e3,function(){console.log("Server listening on port 3000")});